

import React, { useState, useEffect, useMemo } from 'react'; 

import { initializeApp } from 'firebase/app'; 

import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from 'firebase/auth'; 

import { getFirestore, collection, onSnapshot, query, addDoc, serverTimestamp, doc, setLogLevel, updateDoc } from 'firebase/firestore'; 

import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts'; 

import { AlertTriangle, User, Clipboard, TrendingUp, Mic, WifiOff, Heart, FileText, Send, Clock, ChevronDown, ChevronUp, Search, Filter, Check, X, Upload } from 'lucide-react'; 

 

// IMPORTANT: Firebase setup variables (provided by the environment) 

const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {}; 

const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id'; 

const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null; 

 

// The TFLite model expects 10 inputs in this order: 

// 0: age, 1: gender, 2: bp_systolic, 3: sugar_fasting, 4: temp, 5: spo2,  

// 6: symptom_severity, 7: structured_symp_score, 8: hba1c, 9: cholesterol 

const INPUT_VECTOR_SIZE = 10; 

const COMMON_SYMPTOMS = ['Fever', 'Cough', 'Chest Pain', 'Nausea', 'Fatigue', 'Dizziness']; 

 

// Custom hook for Firebase 

const useFirebase = () => { 

â€¯ â€¯ const [authReady, setAuthReady] = useState(false); 

â€¯ â€¯ const [db, setDb] = useState(null); 

â€¯ â€¯ const [auth, setAuth] = useState(null); 

â€¯ â€¯ const [userId, setUserId] = useState(null); 

 

â€¯ â€¯ useEffect(() => { 

â€¯ â€¯ â€¯ â€¯ if (!firebaseConfig.apiKey) return; 

 

â€¯ â€¯ â€¯ â€¯ setLogLevel('debug'); 

â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ const app = initializeApp(firebaseConfig); 

â€¯ â€¯ â€¯ â€¯ const firestoreDb = getFirestore(app); 

â€¯ â€¯ â€¯ â€¯ const firebaseAuth = getAuth(app); 

 

â€¯ â€¯ â€¯ â€¯ setDb(firestoreDb); 

â€¯ â€¯ â€¯ â€¯ setAuth(firebaseAuth); 

 

â€¯ â€¯ â€¯ â€¯ const unsubscribe = onAuthStateChanged(firebaseAuth, async (user) => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ if (user) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setUserId(user.uid); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } else { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ try { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ if (initialAuthToken) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ await signInWithCustomToken(firebaseAuth, initialAuthToken); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } else { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ await signInAnonymously(firebaseAuth); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } catch (error) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ console.error("Firebase Auth Error:", error); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setUserId(crypto.randomUUID());  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setAuthReady(true); 

â€¯ â€¯ â€¯ â€¯ }); 

 

â€¯ â€¯ â€¯ â€¯ return () => unsubscribe(); 

â€¯ â€¯ }, []); 

 

â€¯ â€¯ return { db, auth, userId, authReady }; 

}; 

 

// --- FEATURE 5: ADVANCED ML REFINEMENT --- 

const OfflinePrediction = ({ inputs }) => { 

â€¯ â€¯  

â€¯ â€¯ // --- SIMULATION OF TFLITE PREDICTION --- 

â€¯ â€¯ const riskProb = useMemo(() => { 

â€¯ â€¯ â€¯ â€¯ if (inputs.length !== INPUT_VECTOR_SIZE) return 0.5; 

 

â€¯ â€¯ â€¯ â€¯ // inputs: [age, gender, bp, sugar, temp, spo2, symp_sev, structured_score, hba1c, chol] 

â€¯ â€¯ â€¯ â€¯ const [age, gender, bp, sugar, temp, spo2, symp_sev, structured_score, hba1c, chol] = inputs; 

 

â€¯ â€¯ â€¯ â€¯ let riskScore = -2.0; // Baseline low risk 

 

â€¯ â€¯ â€¯ â€¯ // Core risk factors (linear weights) 

â€¯ â€¯ â€¯ â€¯ if (bp > 150) riskScore += 0.7; 

â€¯ â€¯ â€¯ â€¯ if (sugar > 200) riskScore += 1.1; 

â€¯ â€¯ â€¯ â€¯ if (temp > 38.0) riskScore += 0.4; 

â€¯ â€¯ â€¯ â€¯ if (spo2 < 93) riskScore += 1.3; 

â€¯ â€¯ â€¯ â€¯ if (hba1c > 7.5) riskScore += 1.6; 

â€¯ â€¯ â€¯ â€¯ if (age > 65) riskScore += 0.6; 

â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ // Use the new structured symptom score (Index 7) 

â€¯ â€¯ â€¯ â€¯ riskScore += structured_score * 0.3;  

 

â€¯ â€¯ â€¯ â€¯ // NEW: Interaction terms (simulating advanced ML features) 

â€¯ â€¯ â€¯ â€¯ if (age >= 60 && hba1c > 8.0) riskScore += 1.5; // High Diabetes Risk + Age 

â€¯ â€¯ â€¯ â€¯ if (bp > 160 && chol > 240) riskScore += 1.0; // Hypertension + High Cholesterol 

â€¯ â€¯ â€¯ â€¯ if (spo2 < 90 && structured_score >= 3) riskScore += 2.0; // Severe Respiratory Distress + Severe Symptoms 

â€¯ â€¯ â€¯ â€¯ if (sugar > 250 && temp > 37.8) riskScore += 0.8; // Diabetes + Infection risk 

 

â€¯ â€¯ â€¯ â€¯ // Simple sigmoid approximation 

â€¯ â€¯ â€¯ â€¯ return 1 / (1 + Math.exp(-riskScore)); 

 

â€¯ â€¯ }, [inputs]); 

 

â€¯ â€¯ const riskStatus = riskProb > 0.70 ? 'High Risk' : riskProb > 0.45 ? 'Moderate Risk' : 'Low Risk'; 

â€¯ â€¯ const riskColor = riskProb > 0.70 ? 'bg-red-100 text-red-700 border-red-400' : riskProb > 0.45 ? 'bg-yellow-100 text-yellow-700 border-yellow-400' : 'bg-green-100 text-green-700 border-green-400'; 

 

â€¯ â€¯ return ( 

â€¯ â€¯ â€¯ â€¯ <div className={`p-4 rounded-xl shadow-lg border-2 ${riskColor} transition duration-300 w-full`}> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="flex items-center space-x-3"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <WifiOff size={24} className={riskProb > 0.45 ? 'animate-pulse' : ''} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="font-bold text-xl">Offline Risk Prediction</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="mt-2 text-3xl font-extrabold">{Math.round(riskProb * 100)}%</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-lg font-semibold">{riskStatus}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-xs mt-1 opacity-80">Generated instantly using Advanced TFLite model logic.</p> 

â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ ); 

}; 

 

// Rule-based Advice for Phase 1 

const SymptomAdvice = ({ inputs, structuredSymptoms, symptomNotes }) => { 

â€¯ â€¯ // inputs: [age, gender, bp, sugar, temp, spo2, symp_sev, structured_score, hba1c, chol] 

â€¯ â€¯ const [age, gender, bp, sugar, temp, spo2, symp_sev, structured_score, hba1c, chol] = inputs; 

 

â€¯ â€¯ let advice = { 

â€¯ â€¯ â€¯ â€¯ title: "General Wellness Check", 

â€¯ â€¯ â€¯ â€¯ remedies: ["Maintain hydration (drink 2-3 liters of water).", "Get adequate rest (7-9 hours of sleep)."], 

â€¯ â€¯ â€¯ â€¯ medicines: ["Multivitamin daily for general well-being."], 

â€¯ â€¯ â€¯ â€¯ isAlert: false 

â€¯ â€¯ }; 

â€¯ â€¯  

â€¯ â€¯ const hasChestPain = structuredSymptoms.includes('Chest Pain'); 

â€¯ â€¯ const hasFever = structuredSymptoms.includes('Fever'); 

â€¯ â€¯ const hasCough = structuredSymptoms.includes('Cough'); 

 

â€¯ â€¯ // Rule 1: Immediate Emergency Triage 

â€¯ â€¯ if (spo2 < 90 || bp > 180 || sugar > 300 || hasChestPain) { 

â€¯ â€¯ â€¯ â€¯ advice = { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ title: "ðŸ›‘ CRITICAL ALERT: Seek Emergency Care!", 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ remedies: ["Do not delay. Go to the nearest PHC/Hospital immediately.", "If chest pain, take an aspirin (if not allergic).", "Keep the patient warm and calm."], 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ medicines: ["N/A - Professional diagnosis and immediate treatment is mandatory."], 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ isAlert: true 

â€¯ â€¯ â€¯ â€¯ }; 

â€¯ â€¯ }  

â€¯ â€¯ // Rule 2: High Fever Management 

â€¯ â€¯ else if (temp > 38.5 || hasFever) { 

â€¯ â€¯ â€¯ â€¯ advice = { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ title: "Fever Management & General Illness", 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ remedies: ["Use cold compresses on the forehead/neck.", "Drink warm fluids like soup or herbal tea.", "Rest in a well-ventilated room."], 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ medicines: ["**Paracetamol (500mg)** up to 3 times a day (consult dosage).", "Oral Rehydration Solution (ORS) to manage fluid loss."], 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ isAlert: true 

â€¯ â€¯ â€¯ â€¯ }; 

â€¯ â€¯ }  

â€¯ â€¯ // Rule 3: Cough/Cold Management 

â€¯ â€¯ else if (hasCough || symptomNotes.toLowerCase().includes('cough')) { 

â€¯ â€¯ â€¯ â€¯ â€¯advice = { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ title: "Cough and Cold Relief", 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ remedies: ["Gargle with warm salt water 3-4 times a day.", "Inhale steam twice daily.", "Avoid cold drinks and fried food."], 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ medicines: ["**Dextromethorphan-based** cough syrup (for dry cough).", "**Ambroxol-based** cough syrup (for wet/mucus cough)."], 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ isAlert: false 

â€¯ â€¯ â€¯ â€¯ }; 

â€¯ â€¯ } 

 

â€¯ â€¯ // Determine color 

â€¯ â€¯ const color = advice.isAlert ? 'border-red-500 bg-red-50' : 'border-indigo-500 bg-indigo-50'; 

â€¯ â€¯ const titleColor = advice.isAlert ? 'text-red-700' : 'text-indigo-700'; 

 

â€¯ â€¯ return ( 

â€¯ â€¯ â€¯ â€¯ <div className={`p-5 rounded-xl border-2 ${color} shadow-lg space-y-3 mt-4`}> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className={`font-bold text-xl flex items-center ${titleColor}`}> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FileText size={22} className="mr-2" /> {advice.title} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm italic text-gray-700">Suggestion based on your entered symptoms and vitals:</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-semibold text-sm mt-2 text-gray-800 border-b border-dashed pb-1">Home Remedies & Care:</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <ul className="list-disc list-inside text-sm ml-2 space-y-1 pt-1"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {advice.remedies.map((r, i) => <li key={i}>{r}</li>)} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </ul> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-semibold text-sm mt-3 text-gray-800 border-b border-dashed pb-1">Suggested OTC Medication:</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <ul className="list-disc list-inside text-sm ml-2 space-y-1 pt-1"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {advice.medicines.map((m, i) => <li key={i}>{m}</li>)} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </ul> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-xs italic mt-3 text-gray-500"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ *Disclaimer: These are preliminary suggestions for common ailments. **Always consult a certified healthcare professional** before starting any medication. 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ ); 

}; 

 

// --- FEATURE 2: VITALS RANGE VALIDATION --- 

const getVitalsValidation = (value, field) => { 

â€¯ â€¯ value = parseFloat(value); 

â€¯ â€¯ // CRITICAL (Red) 

â€¯ â€¯ if (field === 'bpSys' && value > 180) return { type: 'critical', message: 'CRITICAL: Dangerously high BP. Seek immediate care.' }; 

â€¯ â€¯ if (field === 'sugarFasting' && value > 300) return { type: 'critical', message: 'CRITICAL: Extreme hyperglycemia.' }; 

â€¯ â€¯ if (field === 'spo2' && value < 85) return { type: 'critical', message: 'CRITICAL: Severe hypoxia. Seek emergency care.' }; 

â€¯ â€¯ if (field === 'temp' && value >= 40.0) return { type: 'critical', message: 'CRITICAL: High fever.' }; 

â€¯ â€¯  

â€¯ â€¯ // WARNING (Yellow) 

â€¯ â€¯ if (field === 'bpSys' && value > 140) return { type: 'warning', message: 'Warning: High BP detected.' }; 

â€¯ â€¯ if (field === 'sugarFasting' && value > 140) return { type: 'warning', message: 'Warning: High sugar detected.' }; 

â€¯ â€¯ if (field === 'spo2' && value < 93) return { type: 'warning', message: 'Warning: Low SpO2, needs attention.' }; 

â€¯ â€¯ if (field === 'temp' && value >= 37.8) return { type: 'warning', message: 'Warning: Fever detected.' }; 

â€¯ â€¯  

â€¯ â€¯ return null; 

}; 

 

// UI Utility function for form fields with validation 

const FormField = ({ label, type = 'text', value, onChange, min, max, step, options, isNumber, validation }) => ( 

â€¯ â€¯ <div className="flex flex-col space-y-1"> 

â€¯ â€¯ â€¯ â€¯ <label className="text-sm font-medium text-gray-700">{label}</label> 

â€¯ â€¯ â€¯ â€¯ {type === 'select' ? ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <select  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={value}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={onChange}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className="p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {options.map(([val, text]) => ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <option key={val} value={val}>{text}</option> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ))} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </select> 

â€¯ â€¯ â€¯ â€¯ ) : type === 'textarea' ? ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <textarea 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={value} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={onChange} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ rows="3" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className="p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ placeholder={label.includes('Notes') ? "Describe your current condition..." : "Enter prescription advice..."} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

â€¯ â€¯ â€¯ â€¯ ) : ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <input 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type={isNumber ? 'number' : type} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={value} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={onChange} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ min={min} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ max={max} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ step={step} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`p-2 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ validation?.type === 'critical' ? 'border-red-500 ring-red-500' :  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ validation?.type === 'warning' ? 'border-yellow-500 ring-yellow-500' : 'border-gray-300' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ {validation && ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className={`text-xs font-semibold mt-1 flex items-center ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ validation.type === 'critical' ? 'text-red-600 animate-pulse' : 'text-yellow-600' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`}> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <AlertTriangle size={14} className="mr-1" /> {validation.message} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </p> 

â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ </div> 

); 

 

// Main App Component 

const App = () => { 

â€¯ â€¯ const { db, userId, authReady } = useFirebase(); 

â€¯ â€¯ const [currentView, setCurrentView] = useState('symptom-checker'); 

â€¯ â€¯ const [reports, setReports] = useState([]); 

â€¯ â€¯ const [loadingReports, setLoadingReports] = useState(false); 

â€¯ â€¯  

â€¯ â€¯ // State for Patient Personal Details 

â€¯ â€¯ const [patientName, setPatientName] = useState('Priya Sharma'); 

â€¯ â€¯ const [patientAddress, setPatientAddress] = useState('123 Gandhi Rd, Village B'); 

 

â€¯ â€¯ // --- FEATURE 1: STRUCTURED SYMPTOM INPUT --- 

â€¯ â€¯ const [structuredSymptoms, setStructuredSymptoms] = useState(['Cough']); // Array of checked symptoms 

â€¯ â€¯ const [symptomNotes, setSymptomNotes] = useState('mild cough and slight body ache'); // Text area for unstructured detail 

â€¯ â€¯ const [bpSys, setBpSys] = useState(120); 

â€¯ â€¯ const [sugarFasting, setSugarFasting] = useState(90); 

â€¯ â€¯ const [hba1c, setHba1c] = useState(5.5); 

â€¯ â€¯ const [cholesterol, setCholesterol] = useState(180); 

â€¯ â€¯ const [age, setAge] = useState(30); 

â€¯ â€¯ const [gender, setGender] = useState(0); // 0=Male, 1=Female 

â€¯ â€¯ const [temp, setTemp] = useState(37.0); 

â€¯ â€¯ const [spo2, setSpo2] = useState(98); 

â€¯ â€¯ const [sympSeverity, setSympSeverity] = useState(1); // 0-3 

 

â€¯ â€¯ // --- FEATURE 4: LAB REPORT SIMULATION --- 

â€¯ â€¯ const [labSimStatus, setLabSimStatus] = useState('N/A'); // 'N/A', 'Normal', 'Warning', 'High Risk' 

 

â€¯ â€¯ // State for Doctor's Prescription 

â€¯ â€¯ const [doctorNotes, setDoctorNotes] = useState(''); 

â€¯ â€¯ const [foodToTake, setFoodToTake] = useState(''); 

â€¯ â€¯ const [prescriptionText, setPrescriptionText] = useState(''); 

â€¯ â€¯ const [selectedReportId, setSelectedReportId] = useState(null);  

â€¯ â€¯ const [prescribing, setPrescribing] = useState(false);  

 

â€¯ â€¯ // --- FEATURE 3: PHC DASHBOARD FILTER/SEARCH --- 

â€¯ â€¯ const [phcFilter, setPhcFilter] = useState('all'); // 'all', 'critical', 'unprescribed', 'prescribed' 

â€¯ â€¯ const [phcSearch, setPhcSearch] = useState(''); 

â€¯ â€¯  

â€¯ â€¯ const [message, setMessage] = useState(''); 

â€¯ â€¯ const [isSaving, setIsSaving] = useState(false); 

â€¯ â€¯ const [userLastReport, setUserLastReport] = useState(null); 

 

â€¯ â€¯ // Mapped vitals for easy validation check 

â€¯ â€¯ const vitalsMap = useMemo(() => ({ 

â€¯ â€¯ â€¯ â€¯ bpSys, sugarFasting, spo2, temp 

â€¯ â€¯ }), [bpSys, sugarFasting, spo2, temp]); 

 

â€¯ â€¯ // Dynamic input vector for TFLite simulation 

â€¯ â€¯ const inputVector = useMemo(() => { 

â€¯ â€¯ â€¯ â€¯ // Index 7 is now the Structured Symptom Score (0-5 scale) 

â€¯ â€¯ â€¯ â€¯ const structuredSymptomScore = structuredSymptoms.length * 0.5 + (parseFloat(sympSeverity) * 0.75);  

 

â€¯ â€¯ â€¯ â€¯ return [ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(age), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(gender), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(bpSys), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(sugarFasting), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(temp), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(spo2), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(sympSeverity), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ Math.min(5.0, structuredSymptomScore), // Index 7: Structured Symptom Score (0-5) 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(hba1c), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ parseFloat(cholesterol), 

â€¯ â€¯ â€¯ â€¯ ]; 

â€¯ â€¯ }, [age, gender, bpSys, sugarFasting, temp, spo2, sympSeverity, structuredSymptoms, hba1c, cholesterol]); 

 

â€¯ â€¯ // Data for Offline Chart Simulation 

â€¯ â€¯ const chartData = useMemo(() => { 

â€¯ â€¯ â€¯ â€¯ const baseRisk = inputVector[7] * 20 + inputVector[6] * 10; 

â€¯ â€¯ â€¯ â€¯ return [ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ { name: 'Day 1', RiskIndex: Math.max(10, baseRisk - 15) }, 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ { name: 'Day 2', RiskIndex: baseRisk }, 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ { name: 'Today', RiskIndex: Math.max(20, inputVector[7] * 20 + inputVector[6] * 15 + 10) }, 

â€¯ â€¯ â€¯ â€¯ ]; 

â€¯ â€¯ }, [inputVector]); 

â€¯ â€¯  

â€¯ â€¯ // Firestore Logic (PHC View: All Reports) 

â€¯ â€¯ useEffect(() => { 

â€¯ â€¯ â€¯ â€¯ if (!db || !authReady || (currentView !== 'phc-view' && currentView !== 'report-entry')) return;  

 

â€¯ â€¯ â€¯ â€¯ setLoadingReports(true); 

â€¯ â€¯ â€¯ â€¯ const collectionPath = `artifacts/${appId}/public/data/health_reports`; 

â€¯ â€¯ â€¯ â€¯ const reportsRef = collection(db, collectionPath); 

â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ const q = query(reportsRef); 

â€¯ â€¯ â€¯ â€¯ const unsubscribe = onSnapshot(q, (snapshot) => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const fetchedReports = snapshot.docs.map(doc => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const data = doc.data(); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ // Check if any critical validation warning was present at submission 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const isTriageRisk = data.riskPrediction?.[2] > 160 || data.riskPrediction?.[5] < 93 || data.riskPrediction?.[3] > 250 || data.structuredSymptoms?.includes('Chest Pain'); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ id: doc.id, 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ...data, 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ isTriageRisk: isTriageRisk,  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ timestamp: data.timestamp ? new Date(data.timestamp.toDate()).toLocaleString() : 'N/A', 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ date: data.timestamp ? data.timestamp.toDate() : new Date(0)  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }); 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ // Sort by triage risk (Critical alerts first) then by latest time 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ fetchedReports.sort((a, b) => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ if (b.isTriageRisk !== a.isTriageRisk) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return b.isTriageRisk ? -1 : 1; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return b.date.getTime() - a.date.getTime(); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }); 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setReports(fetchedReports); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setLoadingReports(false); 

â€¯ â€¯ â€¯ â€¯ }, (error) => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ console.error("Error listening to Firestore (PHC View):", error); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setMessage(`Error loading reports: ${error.message}`); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setLoadingReports(false); 

â€¯ â€¯ â€¯ â€¯ }); 

 

â€¯ â€¯ â€¯ â€¯ return () => unsubscribe(); 

â€¯ â€¯ }, [db, authReady, currentView]); 

 

â€¯ â€¯ // Current User's Last Report 

â€¯ â€¯ useEffect(() => { 

â€¯ â€¯ â€¯ â€¯ if (!authReady || !userId || reports.length === 0) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setUserLastReport(null); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return; 

â€¯ â€¯ â€¯ â€¯ } 

 

â€¯ â€¯ â€¯ â€¯ const userReports = reports 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ .filter(report => report.userId === userId) 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ setUserLastReport(userReports.length > 0 ? userReports[0] : null); 

 

â€¯ â€¯ }, [reports, authReady, userId]); 

 

â€¯ â€¯ // Apply filtering and searching to reports for PHC view 

â€¯ â€¯ const filteredReports = useMemo(() => { 

â€¯ â€¯ â€¯ â€¯ return reports.filter(report => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ // 1. Filter by status 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ if (phcFilter === 'critical' && !report.isTriageRisk) return false; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ if (phcFilter === 'unprescribed' && report.prescription) return false; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ if (phcFilter === 'prescribed' && !report.prescription) return false; 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ // 2. Filter by search term 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const term = phcSearch.toLowerCase().trim(); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ if (term.length > 0) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const matchesName = report.patientName?.toLowerCase().includes(term); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const matchesAddress = report.patientAddress?.toLowerCase().includes(term); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const matchesId = report.userId?.substring(0, 12).toLowerCase().includes(term); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ if (!matchesName && !matchesAddress && !matchesId) return false; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return true; 

â€¯ â€¯ â€¯ â€¯ }); 

â€¯ â€¯ }, [reports, phcFilter, phcSearch]); 

 

â€¯ â€¯ // Function to submit the current health snapshot as a report 

â€¯ â€¯ const handleSubmitReport = async (e) => { 

â€¯ â€¯ â€¯ â€¯ e.preventDefault(); 

â€¯ â€¯ â€¯ â€¯ if (!db || !userId) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setMessage("Authentication is not ready. Please wait."); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return; 

â€¯ â€¯ â€¯ â€¯ } 

 

â€¯ â€¯ â€¯ â€¯ // Check for any critical alerts before submission and stop if found. 

â€¯ â€¯ â€¯ â€¯ if (Object.keys(vitalsMap).some(key => getVitalsValidation(vitalsMap[key], key)?.type === 'critical')) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯setMessage("Cannot submit report: CRITICAL VITAL values detected. Please re-check inputs or seek immediate care."); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯return; 

â€¯ â€¯ â€¯ â€¯ } 

 

â€¯ â€¯ â€¯ â€¯ setIsSaving(true); 

â€¯ â€¯ â€¯ â€¯ setMessage(''); 

 

â€¯ â€¯ â€¯ â€¯ const newReport = { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ userId: userId, 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ patientName: patientName,  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ patientAddress: patientAddress,  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ age: parseFloat(age), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ gender: parseFloat(gender), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ bpSys: parseFloat(bpSys), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ sugarFasting: parseFloat(sugarFasting), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ temp: parseFloat(temp), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ spo2: parseFloat(spo2), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ hba1c: parseFloat(hba1c), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ cholesterol: parseFloat(cholesterol), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ structuredSymptoms, // NEW 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ symptomNotes, // NEW (renamed symptomText) 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ labSimStatus, // NEW 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ sympSeverity: parseFloat(sympSeverity), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ riskPrediction: inputVector.length === INPUT_VECTOR_SIZE ? inputVector : 'Incomplete', 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ // Prescription fields initialized to null 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ prescription: null,  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ doctorNotes: null,  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ foodToTake: null,  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ prescribedBy: null,  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ timestamp: serverTimestamp(), 

â€¯ â€¯ â€¯ â€¯ }; 

 

â€¯ â€¯ â€¯ â€¯ try { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const collectionPath = `artifacts/${appId}/public/data/health_reports`; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ await addDoc(collection(db, collectionPath), newReport); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setMessage("Report successfully saved for PHC review!"); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setSymptomNotes(''); // Clear text after submission 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setLabSimStatus('N/A'); // Reset lab status 

â€¯ â€¯ â€¯ â€¯ } catch (error) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ console.error("Error saving report:", error); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setMessage(`Failed to save report: ${error.message}`); 

â€¯ â€¯ â€¯ â€¯ } finally { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setIsSaving(false); 

â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ }; 

 

â€¯ â€¯ // --- FEATURE 4 HELPER --- 

â€¯ â€¯ const handleSimulateLabUpload = () => { 

â€¯ â€¯ â€¯ â€¯ const statuses = ['Normal', 'Warning', 'High Risk']; 

â€¯ â€¯ â€¯ â€¯ const newStatus = statuses[Math.floor(Math.random() * statuses.length)]; 

â€¯ â€¯ â€¯ â€¯ setLabSimStatus(newStatus); 

â€¯ â€¯ â€¯ â€¯ setMessage(`Simulated lab report status set to: ${newStatus}`); 

â€¯ â€¯ }; 

 

â€¯ â€¯ // Function for PHC Doctor to save the prescription 

â€¯ â€¯ const handleUpdatePrescription = async (e) => { 

â€¯ â€¯ â€¯ â€¯ e.preventDefault(); 

â€¯ â€¯ â€¯ â€¯ if (!db || !selectedReportId) return; 

 

â€¯ â€¯ â€¯ â€¯ setPrescribing(true); 

â€¯ â€¯ â€¯ â€¯ setMessage(''); 

 

â€¯ â€¯ â€¯ â€¯ const prescriberId = userId.substring(0, 12) + '...'; 

 

â€¯ â€¯ â€¯ â€¯ try { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const docRef = doc(db, `artifacts/${appId}/public/data/health_reports`, selectedReportId); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ await updateDoc(docRef, { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ prescription: prescriptionText, 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ doctorNotes: doctorNotes, // Symptom summary/notes 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ foodToTake: foodToTake, // Food advice 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ prescribedBy: `PHC Doctor (User ID: ${prescriberId})`,  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ prescriptionTimestamp: serverTimestamp(), 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }); 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setMessage(`Prescription saved successfully for Report ID ${selectedReportId.substring(0, 8)}.`); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ // Clear prescription states and close the modal/form 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setDoctorNotes(''); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setFoodToTake(''); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setPrescriptionText(''); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setSelectedReportId(null); 

â€¯ â€¯ â€¯ â€¯ } catch (error) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ console.error("Error updating prescription:", error); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setMessage(`Error saving prescription: ${error.message}`); 

â€¯ â€¯ â€¯ â€¯ } finally { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setPrescribing(false); 

â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ }; 

 

â€¯ â€¯ // Render logic for different views 

â€¯ â€¯ const renderContent = () => { 

â€¯ â€¯ â€¯ â€¯ if (!authReady) return ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="text-center p-8 text-indigo-600 font-semibold">Loading App and Authenticating...</div> 

â€¯ â€¯ â€¯ â€¯ ); 

 

â€¯ â€¯ â€¯ â€¯ // Doctor Prescription Form/Modal 

â€¯ â€¯ â€¯ â€¯ const PrescriptionForm = ({ report, allReports, onClose }) => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const patientHistory = useMemo(() => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return allReports 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ .filter(r => r.userId === report.userId && r.id !== report.id) 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ .sort((a, b) => b.date.getTime() - a.date.getTime()); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }, [allReports, report.userId, report.id]); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ const [historyVisible, setHistoryVisible] = useState(true); 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="absolute inset-0 bg-white bg-opacity-95 backdrop-blur-sm z-20 p-4 sm:p-6 rounded-xl shadow-2xl overflow-y-auto"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="text-2xl font-bold text-indigo-700 border-b pb-2 mb-4 flex items-center"><FileText size={28} className="mr-2" /> Write Prescription</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* Patient Summary */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="mb-4 p-3 bg-indigo-50 rounded-lg border border-indigo-200"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-md font-semibold text-indigo-800">Patient: <span className="font-bold">{report.patientName}</span> ({report.age})</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-xs text-gray-600">Address: {report.patientAddress || 'N/A'}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-xs text-gray-600">Report Date: {report.timestamp}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {report.labSimStatus && report.labSimStatus !== 'N/A' && ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯<p className={`mt-2 px-2 py-1 text-xs font-bold rounded inline-block ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ report.labSimStatus === 'High Risk' ? 'bg-red-200 text-red-800' : 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ report.labSimStatus === 'Warning' ? 'bg-yellow-200 text-yellow-800' : 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ 'bg-green-200 text-green-800' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`}>Simulated Lab Status: {report.labSimStatus}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* Patient History Section */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="mb-6 border rounded-lg shadow-inner"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="button" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setHistoryVisible(!historyVisible)} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className="w-full p-3 bg-gray-100 flex justify-between items-center font-semibold text-gray-700 hover:bg-gray-200 rounded-t-lg transition" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <span className="flex items-center"><Clock size={18} className="mr-2" /> Patient History ({patientHistory.length} Past Reports)</span> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {historyVisible ? <ChevronUp size={18} /> : <ChevronDown size={18} />} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {historyVisible && ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="max-h-64 overflow-y-auto p-3 space-y-3 bg-white"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {patientHistory.length === 0 ? ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm text-gray-500 text-center py-2">No past reports found for this patient.</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ) : ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ patientHistory.map((hist, index) => ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div key={hist.id} className="p-3 border rounded-lg bg-gray-50"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-bold text-xs flex justify-between"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <span>Report #{patientHistory.length - index}</span>  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <span className="text-indigo-600">{hist.timestamp}</span> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-xs mt-1"><span className="font-semibold">Vitals:</span> BP {hist.bpSys}/{hist.sugarFasting}, SpO2 {hist.spo2}%</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-xs italic mt-1"><span className="font-semibold">Symptoms:</span> {hist.symptomNotes || 'N/A'}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {hist.prescription && ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="mt-2 text-xs p-2 bg-green-100 rounded"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <span className="font-bold text-green-700">Previous Rx:</span> {hist.prescription.substring(0, 100)}... 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )) 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* End Patient History Section */} 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <form onSubmit={handleUpdatePrescription} className="space-y-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h4 className="text-lg font-bold text-indigo-600">Current Prescription</h4> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ label="Doctor's Notes (Symptoms Analysis)"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="textarea"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={doctorNotes}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={(e) => setDoctorNotes(e.target.value)} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ label="Food/Diet Advice"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="textarea"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={foodToTake}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={(e) => setFoodToTake(e.target.value)} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ label="Prescription (Medicine/Treatment)"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="textarea"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={prescriptionText}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={(e) => setPrescriptionText(e.target.value)} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="flex justify-end space-x-3 pt-4 sticky bottom-0 bg-white p-2 rounded-xl shadow-lg"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="button" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={onClose} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className="px-4 py-2 rounded-xl text-gray-700 bg-gray-200 hover:bg-gray-300 transition" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ Cancel 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="submit" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ disabled={prescribing || !prescriptionText} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`px-4 py-2 rounded-xl font-semibold transition duration-150 flex items-center ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ prescribing ? 'bg-green-300 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700 text-white shadow-md hover:shadow-lg' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {prescribing ? 'Sending...' : 'Send Prescription'} <Send size={16} className="ml-2" /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </form> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ); 

â€¯ â€¯ â€¯ â€¯ }; 

 

â€¯ â€¯ â€¯ â€¯ switch (currentView) { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ case 'symptom-checker': 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="space-y-6"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h2 className="text-2xl font-bold text-gray-800 flex items-center"><Mic size={24} className="mr-2" /> Pocket Doctor Symptom Checker</h2> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="grid grid-cols-1 lg:grid-cols-3 gap-6"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* --- 1. User Input (lg:col-span-2) --- */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="lg:col-span-2 p-6 bg-white rounded-xl shadow-2xl space-y-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="text-xl font-semibold border-b pb-2 mb-4">Symptoms & Vitals Input (Offline Data)</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* FEATURE 1: Structured Symptoms */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="space-y-3 p-4 border rounded-lg bg-indigo-50"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <label className="text-sm font-medium text-gray-700 block">Select Primary Symptoms</label> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="grid grid-cols-3 gap-2 text-sm"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {COMMON_SYMPTOMS.map(symptom => ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ key={symptom} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="button" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ setStructuredSymptoms(prev =>  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ prev.includes(symptom)  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ? prev.filter(s => s !== symptom)  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ : [...prev, symptom] 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`p-2 rounded-lg font-medium transition duration-150 flex items-center justify-center ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ structuredSymptoms.includes(symptom)  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ? 'bg-indigo-600 text-white shadow-md'  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ : 'bg-white text-indigo-700 border border-indigo-300 hover:bg-indigo-100' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {symptom} {structuredSymptoms.includes(symptom) && <Check size={16} className="ml-1" />} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ))} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ label="Additional Symptom Notes"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="textarea"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={symptomNotes}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={(e) => setSymptomNotes(e.target.value)}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="grid grid-cols-2 md:grid-cols-4 gap-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Age" value={age} onChange={(e) => setAge(e.target.value)} min="18" max="100" isNumber={true} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Gender" type="select" value={gender} onChange={(e) => setGender(e.target.value)} options={[[0, 'Male'], [1, 'Female']]} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* FEATURE 2: Vitals Validation */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="BP (Systolic)" value={bpSys} onChange={(e) => setBpSys(e.target.value)} min="90" max="200" isNumber={true} validation={getVitalsValidation(bpSys, 'bpSys')} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Sugar (Fasting)" value={sugarFasting} onChange={(e) => setSugarFasting(e.target.value)} min="70" max="300" isNumber={true} validation={getVitalsValidation(sugarFasting, 'sugarFasting')} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Temperature (Â°C)" value={temp} onChange={(e) => setTemp(e.target.value)} min="35.0" max="42.0" step="0.1" isNumber={true} validation={getVitalsValidation(temp, 'temp')} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="SpO2 (%)" value={spo2} onChange={(e) => setSpo2(e.target.value)} min="80" max="100" isNumber={true} validation={getVitalsValidation(spo2, 'spo2')} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ label="Symptom Severity (Overall)"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="select"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={sympSeverity}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={(e) => setSympSeverity(e.target.value)}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ options={[[0, 'None'], [1, 'Mild'], [2, 'Moderate'], [3, 'High']]} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Total Cholesterol" value={cholesterol} onChange={(e) => setCholesterol(e.target.value)} min="150" max="400" isNumber={true} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* --- 2. Offline Results (lg:col-span-1) --- */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="lg:col-span-1 space-y-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* 2a. TFLite Risk Prediction (FEATURE 5 uses refined logic here) */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <OfflinePrediction inputs={inputVector} />  

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* 2b. Rule-based Symptom Advice */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <SymptomAdvice inputs={inputVector} structuredSymptoms={structuredSymptoms} symptomNotes={symptomNotes} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* 2c. Offline Trend Chart (Kept for completeness) */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="p-4 bg-white rounded-xl shadow-xl border border-gray-200"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="text-md font-semibold border-b pb-1 mb-2 flex items-center text-gray-700"><TrendingUp size={18} className="mr-2 text-indigo-500" /> Risk Trend Simulation</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="h-40 w-full"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <ResponsiveContainer width="100%" height="100%"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <LineChart data={chartData} margin={{ top: 5, right: 10, left: 0, bottom: 5 }}> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <CartesianGrid strokeDasharray="3 3" stroke="#e0e0e0" /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <XAxis dataKey="name" stroke="#333" /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <YAxis domain={[0, 100]} stroke="#333" tick={false} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <Tooltip formatter={(value) => [`${Math.round(value)}%`, 'Risk Index']} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <Line type="monotone" dataKey="RiskIndex" stroke="#6366f1" strokeWidth={3} dot={false} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </LineChart> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </ResponsiveContainer> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ case 'report-entry': 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <form onSubmit={handleSubmitReport} className="p-6 bg-white rounded-xl shadow-2xl space-y-6"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h2 className="text-2xl font-bold text-gray-800 flex items-center"><Clipboard size={24} className="mr-2" /> Phase 2: Report Submission (For PHC)</h2> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm text-gray-500">Enter your details and latest vitals. This report will be saved for review by the Primary Health Center (PHC).</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* Patient Personal Details */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="border p-4 rounded-lg bg-gray-50 space-y-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="text-lg font-semibold text-indigo-600">Patient Personal Details</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="grid grid-cols-1 md:grid-cols-3 gap-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Patient Name" value={patientName} onChange={(e) => setPatientName(e.target.value)} type="text" /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Age" value={age} onChange={(e) => setAge(e.target.value)} min="18" max="100" isNumber={true} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Gender" type="select" value={gender} onChange={(e) => setGender(e.target.value)} options={[[0, 'Male'], [1, 'Female']]} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Address / Location" value={patientAddress} onChange={(e) => setPatientAddress(e.target.value)} type="text" /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* Vitals Input */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="border p-4 rounded-lg space-y-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="text-lg font-semibold text-indigo-600">Latest Vitals & Symptoms</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="grid grid-cols-2 md:grid-cols-3 gap-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="BP (Systolic)" value={bpSys} onChange={(e) => setBpSys(e.target.value)} min="90" max="200" isNumber={true} validation={getVitalsValidation(bpSys, 'bpSys')} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Sugar (Fasting)" value={sugarFasting} onChange={(e) => setSugarFasting(e.target.value)} min="70" max="300" isNumber={true} validation={getVitalsValidation(sugarFasting, 'sugarFasting')} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="HbA1c (%)" value={hba1c} onChange={(e) => setHba1c(e.target.value)} min="4.0" max="15.0" step="0.1" isNumber={true} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Total Cholesterol" value={cholesterol} onChange={(e) => setCholesterol(e.target.value)} min="150" max="400" isNumber={true} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="Temperature (Â°C)" value={temp} onChange={(e) => setTemp(e.target.value)} min="35.0" max="42.0" step="0.1" isNumber={true} validation={getVitalsValidation(temp, 'temp')} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField label="SpO2 (%)" value={spo2} onChange={(e) => setSpo2(e.target.value)} min="80" max="100" isNumber={true} validation={getVitalsValidation(spo2, 'spo2')} /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="space-y-3"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <label className="text-sm font-medium text-gray-700 block">Structured Symptoms Selected:</label> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="flex flex-wrap gap-2 text-sm"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {structuredSymptoms.length > 0 ? ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ structuredSymptoms.map(s => ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <span key={s} className="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full font-semibold">{s}</span> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )) 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ) : ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <span className="text-gray-500 italic">No primary symptoms selected.</span> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <FormField  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ label="Symptom Notes (Detailed description)"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="textarea"  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={symptomNotes}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={(e) => setSymptomNotes(e.target.value)}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* FEATURE 4: LAB REPORT SIMULATION */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="p-3 border rounded-lg flex flex-col sm:flex-row items-center justify-between bg-gray-50"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-semibold text-sm text-gray-700 mb-2 sm:mb-0">Simulated Lab Report Status:</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="flex items-center space-x-3"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <span className={`px-3 py-1 text-sm font-bold rounded-full ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ labSimStatus === 'High Risk' ? 'bg-red-200 text-red-800' : 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ labSimStatus === 'Warning' ? 'bg-yellow-200 text-yellow-800' : 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ labSimStatus === 'Normal' ? 'bg-green-200 text-green-800' : 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ 'bg-gray-200 text-gray-800' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`}> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {labSimStatus} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </span> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="button" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={handleSimulateLabUpload} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className="py-2 px-4 bg-purple-600 text-white rounded-xl text-sm font-semibold hover:bg-purple-700 transition flex items-center shadow-md" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <Upload size={16} className="mr-2" /> Simulate Lab/Image 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="submit" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ disabled={isSaving} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`w-full py-3 px-4 rounded-xl font-semibold transition duration-150 ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ isSaving ? 'bg-indigo-300 cursor-not-allowed' : 'bg-indigo-600 hover:bg-indigo-700 text-white shadow-md hover:shadow-lg' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {isSaving ? 'Submitting Report...' : 'Submit Report for PHC Review'} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {message && <p className={`mt-2 p-2 rounded ${message.includes('Error') || message.includes('CRITICAL') ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}`}>{message}</p>} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* Display Doctor's Prescription (Analysis) */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {userLastReport && ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="border-t pt-6 mt-6"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="text-xl font-bold text-green-700 flex items-center mb-4"><Heart size={24} className="mr-2" /> Latest Doctor's Analysis (Report ID: {userLastReport.id.substring(0, 8)}...)</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {userLastReport.prescription ? ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="bg-green-50 p-4 rounded-xl shadow-inner space-y-3"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm text-gray-700">Received on: <span className="font-semibold">{userLastReport.prescriptionTimestamp ? new Date(userLastReport.prescriptionTimestamp.toDate()).toLocaleString() : 'N/A'}</span> by <span className="font-semibold">{userLastReport.prescribedBy || 'PHC Doctor'}</span></p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="bg-white p-3 rounded border"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-bold text-sm text-gray-800">Doctor Notes (Symptoms Summary):</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm whitespace-pre-wrap">{userLastReport.doctorNotes || 'No notes provided.'}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="bg-white p-3 rounded border"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-bold text-sm text-gray-800">Food/Diet Advice:</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm whitespace-pre-wrap">{userLastReport.foodToTake || 'No food advice provided.'}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="bg-indigo-100 p-3 rounded border-2 border-indigo-400"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-bold text-md text-indigo-700">Prescription:</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm whitespace-pre-wrap">{userLastReport.prescription}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ) : ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="p-4 bg-yellow-50 text-yellow-700 rounded-lg"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ No prescription received yet for your latest report. Please check back later. 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </form> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ case 'phc-view': 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="space-y-6"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h2 className="text-2xl font-bold text-gray-800 flex items-center"><User size={24} className="mr-2" /> PHC View: Public Reports Dashboard</h2> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm text-gray-500">Review patient reports and add prescriptions. Your User ID: <code className="font-mono text-sm break-all">{userId || 'N/A'}</code></p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* FEATURE 3: Filtering and Search Controls */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="p-4 bg-white rounded-xl shadow-md space-y-3"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="font-bold text-indigo-600 flex items-center"><Filter size={18} className="mr-2" /> Report Filtering & Search</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* Search */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="relative"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <Search size={18} className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <input 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ type="text" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ placeholder="Search by Patient Name, Address, or User ID..." 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ value={phcSearch} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onChange={(e) => setPhcSearch(e.target.value)} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className="w-full p-2 pl-10 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ /> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* Filters */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="flex flex-wrap gap-2 text-sm pt-2"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setPhcFilter('all')} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`px-3 py-1.5 rounded-full font-semibold transition ${phcFilter === 'all' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700'}`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ All Reports 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setPhcFilter('critical')} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`px-3 py-1.5 rounded-full font-semibold transition ${phcFilter === 'critical' ? 'bg-red-600 text-white' : 'bg-red-100 text-red-700'}`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <AlertTriangle size={16} className="inline mr-1" /> Critical Alerts 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setPhcFilter('unprescribed')} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`px-3 py-1.5 rounded-full font-semibold transition ${phcFilter === 'unprescribed' ? 'bg-yellow-600 text-white' : 'bg-yellow-100 text-yellow-700'}`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <X size={16} className="inline mr-1" /> Unprescribed 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setPhcFilter('prescribed')} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`px-3 py-1.5 rounded-full font-semibold transition ${phcFilter === 'prescribed' ? 'bg-green-600 text-white' : 'bg-green-100 text-green-700'}`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <Check size={16} className="inline mr-1" /> Prescribed 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {loadingReports ? ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="text-center p-8 text-indigo-600 font-semibold">Loading Reports...</div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ) : ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {filteredReports.length === 0 && <p className="text-center md:col-span-3 text-gray-500 py-6">No reports match the current filter/search criteria.</p>} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {filteredReports.map((report) => ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ key={report.id}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`bg-white p-4 rounded-xl shadow-lg border-l-8 transition duration-200 relative ${report.isTriageRisk ? 'border-red-500' : 'border-green-500'}`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {/* Show prescription form if this report is selected */} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {selectedReportId === report.id && <PrescriptionForm  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ report={report}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ allReports={reports}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClose={() => setSelectedReportId(null)}  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ />} 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="flex justify-between items-start border-b pb-2 mb-2"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h3 className="font-bold text-indigo-600 text-sm">Report ID: {report.id.substring(0, 8)}...</h3> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <span className={`px-2 py-0.5 text-xs font-semibold rounded-full ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ report.isTriageRisk ? 'bg-red-600 text-white animate-pulse' : 'bg-green-600 text-white' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`}> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {report.isTriageRisk ? 'CRITICAL ALERT' : 'Routine'} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </span> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-xs text-gray-600 mb-1">Date: {report.timestamp}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-bold text-sm mb-2 text-gray-800">Patient: {report.patientName || 'N/A'} ({report.age || '?'})</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-xs text-gray-600 break-all mb-2">User ID: {report.userId?.substring(0, 12)}...</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="text-sm space-y-1 border-t pt-2"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p><span className="font-semibold">BP/Sugar:</span> {report.bpSys} / {report.sugarFasting}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="italic text-xs mt-1">Symptoms: {report.symptomNotes || 'N/A'}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {report.labSimStatus && report.labSimStatus !== 'N/A' && ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className={`text-xs font-bold ${ 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ report.labSimStatus === 'High Risk' ? 'text-red-600' : 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ report.labSimStatus === 'Warning' ? 'text-yellow-600' : 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ 'text-green-600' 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ }`}>Lab Status: {report.labSimStatus}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="mt-3"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {report.prescription ? ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="text-xs p-2 bg-green-100 rounded border border-green-300"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="font-bold text-green-700">Prescribed!</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-gray-600 truncate">By: {report.prescribedBy || 'N/A'}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ) : ( 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setSelectedReportId(report.id)} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className="w-full text-xs py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg transition font-semibold" 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ Add Prescription 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ))} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ )} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ ); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ default: 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ return null; 

â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ }; 

 

â€¯ â€¯ return ( 

â€¯ â€¯ â€¯ â€¯ <div className="min-h-screen bg-gray-50 font-sans p-4 sm:p-8"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <style> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {` 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap'); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ body { font-family: 'Inter', sans-serif; } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ .tab-button { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ padding: 0.75rem 1.5rem; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ border-radius: 9999px; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ font-weight: 600; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ transition: all 0.2s; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ .tab-button.active { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ background-color: #6366f1; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ color: white; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ .tab-button.inactive { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ background-color: #e0e7ff; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ color: #4f46e5; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ opacity: 0.8; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ input[type="number"], input[type="text"], select, textarea { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ transition: all 0.2s; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ input[type="number"]:focus, input[type="text"]:focus, select:focus, textarea:focus { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ border-color: #6366f1; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2); 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ .animate-pulse { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite; 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ @keyframes pulse { 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ 0%, 100% { opacity: 1; } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ 50% { opacity: 0.5; } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ } 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ `} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </style> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯  

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <header className="mb-8 p-4 bg-white rounded-xl shadow-lg sticky top-0 z-10"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <h1 className="text-3xl font-extrabold text-indigo-700 flex items-center"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <AlertTriangle size={32} className="mr-3 text-red-500" /> Gram Arogya Health Portal 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </h1> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p className="text-sm text-gray-500 mt-1">Integrated TFLite symptom checking and PHC report management.</p> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <div className="flex space-x-4 mt-4 overflow-x-auto pb-2"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`tab-button ${currentView === 'symptom-checker' ? 'active' : 'inactive'}`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setCurrentView('symptom-checker')} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ Pocket Doctor (Offline ML) 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`tab-button ${currentView === 'report-entry' ? 'active' : 'inactive'}`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setCurrentView('report-entry')} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ Phase 2: Report Entry & Analysis 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <button 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ className={`tab-button ${currentView === 'phc-view' ? 'active' : 'inactive'}`} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ onClick={() => setCurrentView('phc-view')} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ > 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ Phase 3: PHC Doctor View 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </button> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </header> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <main className="max-w-7xl mx-auto"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ {renderContent()} 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </main> 

 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <footer className="mt-8 text-center text-xs text-gray-400"> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p>Application ID: {appId}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ <p>Auth Status: {userId ? `Authenticated (UID: ${userId.substring(0, 12)}...)` : 'Awaiting Authentication'}</p> 

â€¯ â€¯ â€¯ â€¯ â€¯ â€¯ </footer> 

â€¯ â€¯ â€¯ â€¯ </div> 

â€¯ â€¯ ); 

}; 

 

export default App; 

 

 